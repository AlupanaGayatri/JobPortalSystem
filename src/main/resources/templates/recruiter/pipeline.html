<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/recruiter-layout}">

<head>
    <title>Hiring Pipeline</title>
    <style>
        .kanban-board {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            padding-bottom: 2rem;
            min-height: calc(100vh - 200px);
        }

        .kanban-column {
            flex: 0 0 300px;
            background-color: rgba(44, 44, 26, 0.7);
            /* Glass Card Style */
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1rem;
            border: 1px solid rgba(240, 240, 224, 0.1);
        }

        .kanban-header {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--gold);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
        }

        .kanban-card {
            background-color: rgba(0, 0, 0, 0.2);
            /* Darker Inset for cards */
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: move;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .kanban-card:hover {
            transform: translateY(-2px);
            background-color: rgba(255, 255, 255, 0.05);
            /* Lighten on hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-color: var(--gold);
        }
    </style>
</head>

<body>
    <div layout:fragment="content">
        <div class="page-header mb-4">
            <h1 class="text-cream">Hiring Pipeline</h1>
            <p class="text-truffle">Track candidates through stages</p>
        </div>

        <div class="kanban-board">
            <!-- APPLIED Column -->
            <div class="kanban-column">
                <div class="kanban-header" style="border-color: #0dcaf0;">
                    <span>Applied</span>
                    <span class="badge bg-info text-dark" th:text="${appliedCount}">0</span>
                </div>
                <div class="kanban-list" id="col-applied">
                    <div th:each="app : ${applications}"
                        th:if="${app.status == 'APPLIED' or app.status == 'PENDING' or app.status == 'REVIEWED'}"
                        class="kanban-card">
                        <div class="d-flex justify-content-between mb-2">
                            <small class="text-gold" th:text="${app.job.title}">Job Title</small>
                            <small class="text-truffle"
                                th:text="${#temporals.format(app.appliedDate, 'MMM dd')}">Date</small>
                        </div>
                        <h6 class="text-cream mb-1" th:text="${app.user.fullName}">Candidate Name</h6>
                        <div class="d-flex justify-content-end mt-2">
                            <a th:href="@{'/jobs/' + ${app.job.id} + '/applications'}"
                                class="btn btn-sm btn-outline-light py-0" style="font-size: 0.8rem;">View</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SHORTLISTED Column (Assuming STATUS 'SHORTLISTED' exists or we map it) -->
            <div class="kanban-column">
                <div class="kanban-header" style="border-color: #ffc107;">
                    <span>Shortlisted</span>
                    <span class="badge bg-warning text-dark" th:text="${shortlistedCount}">0</span>
                </div>
                <div class="kanban-list">
                    <div th:each="app : ${applications}" th:if="${app.status == 'SHORTLISTED'}" class="kanban-card">
                        <div class="d-flex justify-content-between mb-2">
                            <small class="text-gold" th:text="${app.job.title}">Job Title</small>
                            <small class="text-truffle"
                                th:text="${#temporals.format(app.appliedDate, 'MMM dd')}">Date</small>
                        </div>
                        <h6 class="text-cream mb-1" th:text="${app.user.fullName}">Name</h6>
                        <div class="d-flex justify-content-end mt-2">
                            <a th:href="@{'/jobs/' + ${app.job.id} + '/applications'}"
                                class="btn btn-sm btn-outline-light py-0" style="font-size: 0.8rem;">View</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- INTERVIEW Column -->
            <div class="kanban-column">
                <div class="kanban-header" style="border-color: #6610f2;">
                    <span>Interview</span>
                    <span class="badge bg-primary" th:text="${interviewCount}">0</span>
                </div>
                <div class="kanban-list">
                    <div th:each="app : ${applications}" th:if="${app.status == 'INTERVIEW'}" class="kanban-card">
                        <div class="d-flex justify-content-between mb-2">
                            <small class="text-gold" th:text="${app.job.title}">Job Title</small>
                            <small class="text-truffle"
                                th:text="${#temporals.format(app.appliedDate, 'MMM dd')}">Date</small>
                        </div>
                        <h6 class="text-cream mb-1" th:text="${app.user.fullName}">Name</h6>
                        <div class="d-flex justify-content-end mt-2">
                            <a th:href="@{'/jobs/' + ${app.job.id} + '/applications'}"
                                class="btn btn-sm btn-outline-light py-0" style="font-size: 0.8rem;">View</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- REJECTED/OFFER Column -->
            <div class="kanban-column">
                <div class="kanban-header" style="border-color: #198754;">
                    <span>Hired</span>
                    <span class="badge bg-success" th:text="${hiredCount}">0</span>
                </div>
                <div class="kanban-list">
                    <div th:each="app : ${applications}" th:if="${app.status == 'HIRED'}" class="kanban-card">
                        <div class="d-flex justify-content-between mb-2">
                            <small class="text-gold" th:text="${app.job.title}">Job Title</small>
                            <small class="text-truffle"
                                th:text="${#temporals.format(app.appliedDate, 'MMM dd')}">Date</small>
                        </div>
                        <h6 class="text-cream mb-1" th:text="${app.user.fullName}">Name</h6>
                        <div class="text-end mt-2"><i class="fas fa-check-circle text-success"></i></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>